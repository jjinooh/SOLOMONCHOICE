<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 페이지 타이틀도 핫핑크에 맞춰서 수정할게요. -->
    <title style="color: #FF1493;">솔로몬의 선택: 내 연애 성향은 에겐? 테토?</title>
    <script src="https://developers.kakao.com/sdk/js/kakao.min.js"></script>
    <script>
      Kakao.init('c2788857d449e26583d58b707ee0abb0');
    </script>

    <style>
        /* 기본 폰트와 스타일 */
        body {
            font-family: "Arial", "Noto Sans KR", sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
            text-align: center;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        /* 공통 컨테이너 스타일 - 정사각형 크기 */
        .container {
            background: #fff;
            margin: 20px auto;
            width: 420px;
            height: auto;
            min-height: 420px; /* 컨테이너 최소 높이 (정사각형 모양 유지를 위함) */
            max-height: 600px; /* 컨테이너 최대 높이 (내용이 넘치지 않도록) */
            overflow-y: auto; /* 내용이 넘치면 스크롤 */
            padding: 70px 20px 30px 20px;
            box-sizing: border-box;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        /* 페이지 제목 스타일 (컨테이너 외부 상단 고정) */
        .page-title {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 40px);
            text-align: center;
            font-size: 16px;
            color: #FF1493; /* '솔로몬의 선택' 핫핑크색 */
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            z-index: 10;
        }

        /* 인트로 화면 */
        #intro {
            display: flex; /* 초기에는 인트로 화면을 표시 */
        }
        /* H1 태그에도 핫핑크 적용 */
        h1 {
            font-size: 18px;
            margin-bottom: 10px;
            color: #FF1493; /* '솔로몬의 선택' 핫핑크색 */
        }
        /* 본문 p 태그 스타일 */
        p {
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 15px;
        }

        /* 질문 화면 */
        .question-container {
            text-align: left;
            padding-top: 50px; /* 상단 고정 제목과 겹치지 않도록 여백 */
        }
        .question {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            line-height: 1.7; /* 줄 간격 좀 더 넓게 */
            word-break: keep-all; /* 단어 단위 줄바꿈 (한글) */
            overflow-wrap: break-word; /* 긴 단어도 줄바꿈 */
            white-space: normal; /* **여기 수정!** pre-line 대신 normal로 자동 줄바꿈 사용 */
        }
        .options {
            margin-bottom: 20px;
        }
        .option {
            display: block;
            background-color: #f1f1f1;
            border-radius: 5px;
            padding: 12px 15px; /* 패딩 살짝 늘림 */
            margin-bottom: 10px; /* 간격 늘림 */
            font-size: 15px; /* 글씨 크기 키움 */
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            word-break: keep-all; /* 단어 단위 줄바꿈 (한글) */
            white-space: normal; /* **여기 수정!** pre-line 대신 normal로 자동 줄바꿈 사용 */
            line-height: 1.5; /* 줄 간격 추가 */
        }
        .option:hover {
            background-color: #e6e6e6;
            transform: translateY(-1px);
        }
        .option.selected {
            background-color: #ff8dc7;
            color: white;
            font-weight: bold;
            border: 1px solid #ff1493;
        }
        /* 버튼 공통 스타일 */
        button {
            background-color: #ff3c7e;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 13px;
            border-radius: 20px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.2s;
        }
        button:hover {
            background-color: #e1326f;
        }
        .start-btn { /* 시작하기 버튼은 좀 더 크게 */
            padding: 10px 20px;
            font-size: 14px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        .prev-btn, .next-btn {
            flex-grow: 1; /* 너비를 동일하게 */
            margin: 0 5px;
        }
        .prev-btn:disabled, .next-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        /* 결과 화면 */
        .result-title {
            font-size: 22px; /* 글씨 크기 키움 */
            font-weight: bold;
            margin-bottom: 15px;
            color: #e1326f;
        }
        .result-description {
            font-size: 15px; /* 글씨 크기 키움 */
            line-height: 1.5;
            margin-bottom: 20px;
            text-align: center;
        }
        .comment { /* 인트로 페이지 하단 코멘트 */
            font-size: 11px;
            color: #777;
            position: relative; 
            margin-top: 15px;
            width: 90%;
            text-align: center;
        }
        /* 각 문항 아래에 들어갈 이벤트 설명 텍스트 */
        .event-description-text {
            font-size: 11px;
            color: #888;
            margin-top: 15px;
            line-height: 1.3;
            text-align: center;
        }

        /* 결과 페이지 버튼 나란히 배치 */
        .button-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
        }

        /* 공유 옵션 메뉴 */
        .share-container {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            margin-bottom: 15px;
        }
        .share-btn {
            flex: 0 0 auto;
            margin: 2px;
            white-space: nowrap;
            min-width: fit-content;
            font-size: 11px;
            padding: 6px 10px;
            border-radius: 15px;
            background-color: #6c757d;
        }
        .share-btn:hover {
            background-color: #5a6268;
        }

        /* 결과 페이지 하단 신청 섹션 */
        .apply-section {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .apply-section p {
            font-size: 14px; /* 글씨 크기 키움 */
            line-height: 1.5;
            margin-bottom: 10px;
        }
        .apply-section a {
            display: inline-block;
            background-color: #e1326f;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 15px; /* 글씨 크기 키움 */
            margin-top: 5px;
            transition: background-color 0.2s;
        }
        .apply-section a:hover {
            background-color: #ff3c7e;
        }

        /* Made by */
        .made-by {
            font-size: 11px; /* 폰트 크기 키움 */
            color: #b0b0b0; /* 살짝 더 진하게 */
            font-weight: bold; /* 더 진하게 */
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px dashed #eee;
        }

        /* 진행률 바 */
        .progress-container {
            width: 100%;
            background-color: #e9ecef;
            border-radius: 5px;
            height: 8px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            width: 0;
            background-color: #ff1493;
            border-radius: 5px;
            transition: width 0.3s ease-in-out;
        }

        /* 모바일 반응형 */
        @media (max-width: 450px) {
            body {
                padding: 10px;
            }
            .container {
                width: 95vw;
                height: auto;
                min-height: 95vw;
                max-height: 600px;
                margin: 0 auto;
                padding: 50px 15px 20px 15px;
            }
            .page-title {
                font-size: 14px;
            }
            h1 {
                font-size: 16px;
            }
            p {
                font-size: 12px;
            }
            .question {
                font-size: 15px;
            }
            .option {
                font-size: 14px; /* 모바일에서도 선택 문항 글씨 크기 유지 */
                padding: 8px 12px;
            }
            .result-title {
                font-size: 20px; /* 모바일에서도 결과 제목 글씨 크기 유지 */
            }
            .result-description {
                font-size: 14px; /* 모바일에서도 결과 설명 글씨 크기 유지 */
            }
            .share-btn, .restart-btn, button {
                font-size: 12px;
                padding: 6px 10px;
            }
            .apply-section p {
                font-size: 13px; /* 모바일에서도 신청 문구 글씨 크기 유지 */
            }
            .apply-section a {
                font-size: 13px;
                padding: 6px 12px;
            }
            .made-by {
                font-size: 10px; /* 모바일에서도 Made by 글씨 크기 유지 */
            }
        }
    </style>
</head>
<body>
    <!-- 상단 페이지 제목 -->
    <div class="page-title">솔로몬의 선택: 내 연애 성향은 에겐? 테토?</div>

    <!-- 인트로 화면 -->
    <div class="container" id="intro">
        <!-- '솔로몬의 선택' 제목에도 EMOJI_3 이모지 추가 -->
        <h1>솔로몬의 선택 EMOJI_4</h1>
        <p>이 테스트는 당신 안의 <strong>에겐(감성/공감 특성)</strong>과 <strong>테토(논리/이성 특성)</strong> 비율을 알아보는 유머러스한 분석입니다.</p>
        <p>사랑 앞에서 내가 왜 이러지? 궁금했다면, 이제 알아볼 시간!</p>
        <p><strong>12가지 문항</strong>에 솔직하게 답하고, 당신의 연애 성향 타입을 확인해보세요.</p>
        <button class="start-btn" id="startBtn">테스트 시작하기</button>
        <div class="comment">
            "너무 깊게 생각하지 마세요! 그저 재미로 즐겨주세요."
            <br>
            "본 테스트는 오락용이며, 실제 과학적 근거와는 무관합니다."
        </div>
    </div>

    <!-- 질문 화면 -->
    <div class="container" id="questionContainer">
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="question" id="questionText"></div>
        <div class="options" id="optionsContainer"></div>
        <!-- 이벤트 설명 텍스트가 여기 동적으로 추가됩니다 -->
        <div class="navigation">
            <button class="prev-btn" id="prevBtn">이전</button>
            <button class="next-btn" id="nextBtn">다음</button>
        </div>
    </div>

    <!-- 결과 화면 -->
    <div class="container" id="resultContainer">
        <div class="result-title" id="resultTitle"></div>
        <div class="result-description" id="resultDescription"></div>
        
        <!-- 버튼 나란히 배치 -->
        <div class="button-container">
            <button class="share-my-result-btn" id="shareMyResultBtn">내 결과 공유하기</button>
            <button class="restart-btn" id="restartBtn">다시 테스트하기</button>
        </div>
        
        <!-- 공유 메뉴 (초기에는 숨겨짐) -->
        <div class="share-container" id="shareOptionContainer" style="display: none;">
            <button class="share-btn" id="copyUrl">링크 복사</button>
            <button class="share-btn" id="shareKakao">카카오톡</button>
            <button class="share-btn" id="shareFacebook">페이스북</button>
            <button class="share-btn" id="shareLine">라인</button>
            <button class="share-btn" id="shareX">X (트위터)</button>
        </div>

        <div class="apply-section">
            <p>내 이상형을 만나고 싶다면?</p>
            <p>성남시 청춘남녀 만남행사 'SOLO MON의 선택'에 참가하세요!</p>
            <a href="https://www.seongnam.go.kr/apply/view.do?appIdx=2987&currentPage=1" target="_blank">행사 신청하러 가기</a>
        </div>
        <div class="made-by">Made by JINO</div>
    </div>

    <script>
        // DOM 요소 가져오기
        const introSection = document.getElementById('intro');
        const questionSection = document.getElementById('questionContainer');
        const resultSection = document.getElementById('resultContainer');
        const startBtn = document.getElementById('startBtn');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const progressBar = document.getElementById('progressBar');
        const resultTitle = document.getElementById('resultTitle');
        const resultDescription = document.getElementById('resultDescription');
        const restartBtn = document.getElementById('restartBtn');
        
        // 공유 관련 버튼 및 컨테이너
        const shareMyResultBtn = document.getElementById('shareMyResultBtn');
        const shareOptionContainer = document.getElementById('shareOptionContainer');
        const copyUrlBtn = document.getElementById('copyUrl');
        const shareKakaoBtn = document.getElementById('shareKakao');
        const shareFacebookBtn = document.getElementById('shareFacebook');
        const shareLineBtn = document.getElementById('shareLine');
        const shareXBtn = document.getElementById('shareX');


        let currentQuestionIndex = 0;
        let userAnswers = []; // 사용자의 답변 (선택한 옵션의 type을 저장)
        let egenScore = 0;
        let tetoScore = 0;

        // 질문 목록 (아리까리 버전 12개)
        // **수동 <br> 태그 모두 제거**
        const questions = [
            {
                question: "1. 애인이 밤새 직접 만들었다며 삐뚤빼뚤한 코바늘 인형을 건넸을 때, 당신의 반응은?",
                options: [
                    { text: "우와, 정말 대단하다! 이걸 만드느라 얼마나 고생했을까. 정성 담긴 마음에 감동했어. 정말 고마워!", type: "egen" },
                    { text: "오, 직접 만들었어? 솜씨 좋은데! 그런데 이거... 완성하는 데 정확히 몇 시간 정도 걸렸어? 다음엔 뭘 만들 거야?", type: "teto" }
                ]
            },
            {
                question: "2. 친구가 대뜸 '야, 나 어제 인생 최대의 현타가 왔잖아!'라고 했을 때, 당신의 속마음은?",
                options: [
                    { text: "무슨 일이야? 괜찮아? 내가 지금 네 옆에 있으니까 뭐든 이야기해도 돼.", type: "egen" },
                    { text: "현타가 왔다면 분명 원인이 있을 텐데. 내가 도울 수 있는 문제인가? 어떤 부분에서 스트레스를 받고 있어?", type: "teto" }
                ]
            },
            {
                question: "3. 데이트 중 로맨틱 코미디 영화를 보다가 주인공이 이별하는 장면에서 당신의 모습은?",
                options: [
                    { text: "아... 너무 안됐다. 내가 다 마음이 아프네. 그래도 혹시 이별 후 더 성장하는 계기가 될까?", type: "egen" },
                    { text: "음... 이별은 개연성이 있었던 것 같아. 이미 빌드업이 있었고, 각자의 길이 맞는 결론이지 않을까? 감정 소모는 최소화하는 게 합리적이야.", type: "teto" }
                ]
            },
            {
                question: "4. 애인이 갑자기 '자기야, 나 요즘 살찐 것 같아...'라고 걱정스럽게 말했을 때, 당신의 필살기는?",
                options: [
                    { text: "에이, 무슨 소리야! 내 눈에는 항상 멋지고 예쁜데! 그런 생각 하지도 마. 사랑스러워 죽겠구만!", type: "egen" },
                    { text: "자기만 그런 생각을 하는 건 아니야. 요즘 식단이 좀 불규칙했지? 같이 운동하거나 식단 조절해볼까? 해결책을 찾아야지.", type: "teto" }
                ]
            },
            {
                question: "5. 주말 아침, 애인이 '오늘 뭐 할까?'라고 물어봤을 때, 당신의 머릿속 시뮬레이션은?",
                options: [
                    { text: "갑자기 물어보네? 음... 날씨도 좋고, 애인이 뭘 좋아할지 기분 맞춰서 유동적으로 정해볼까? 소소한 재미를 찾아봐야겠다.", type: "egen" },
                    { text: "예상치 못한 질문이군. 오늘 스케줄 리스트에서 우선순위를 정하고, 효율적으로 보낼 수 있는 활동들을 추려봐야겠어.", type: "teto" }
                ]
            },
            {
                question: "6. 친구와 싸우고 화해하려 할 때, 가장 먼저 하는 생각은?",
                options: [
                    { text: "친구가 얼마나 서운했을까... 내 말실수가 있었는지 다시 곱씹어보고, 어떤 말로 먼저 사과할지 생각해야겠다.", type: "egen" },
                    { text: "무엇 때문에 싸우게 되었는지 원인을 먼저 분석하고, 다시는 같은 문제로 싸우지 않도록 해결 방안을 모색해야겠다.", type: "teto" }
                ]
            },
            {
                question: "7. 애인이 데이트 룩으로 평소 입지 않던 과감한 의상을 입고 왔을 때, 당신의 반응은?",
                options: [
                    { text: "헐, 자기야! 오늘 컨셉 완전히 바뀌었네? 와, 새롭다! 뭔가 다른 사람 만난 것 같고, 엄청 매력적이야!", type: "egen" },
                    { text: "오, 스타일이 바뀌었군. 이런 색감이나 핏은 새로운 시도인 것 같아. 어떤 변화를 주고 싶었던 거야? 잘 어울려.", type: "teto" }
                ]
            },
            {
                question: "8. 당신은 모임의 총무를 맡았다. 정산 중 138,500원이 남았는데, 남은 돈 처리에 대한 당신의 생각은?",
                options: [
                    { text: "애매한 금액이 남았네. 총무로서 감사의 의미로 맛있는 커피라도 한 잔씩 돌리거나, 따뜻한 마음으로 소액 기부를 해볼까?", type: "egen" },
                    { text: "오차가 발생했나? 금액 사용처를 다시 검토하고, 남은 돈은 다음 회비에서 공제하거나 비상금으로 관리하는 게 좋겠어.", type: "teto" }
                ]
            },
            {
                question: "9. 새로운 챌린지를 시작했는데, 생각보다 너무 힘들 때, 당신의 행동은?",
                options: [
                    { text: "하... 너무 힘드네. 그래도 나를 응원하는 사람들이 있으니 포기하지 말고 조금만 더 힘내 볼까? 스스로에게 격려가 필요해.", type: "egen" },
                    { text: "지금 효율이 너무 낮아. 이대로는 목표 달성이 어렵겠군. 현재까지의 데이터를 분석해서 전략을 재수정하거나 도움을 요청해야겠다.", type: "teto" }
                ]
            },
            {
                question: "10. 친구와 단둘이 해외여행을 간다! 숙소를 고를 때, 당신의 최우선 고려사항은?",
                options: [
                    { text: "일단 숙소 사진부터 볼까? 뭔가 로맨틱하고 아늑한 분위기에, 예쁜 야경을 볼 수 있는 곳이면 좋겠다! 인생샷 건져야지!", type: "egen" },
                    { text: "숙소 위치와 교통 편의성이 가장 중요해. 이동 시간을 최소화하고, 주변 맛집이나 관광지와의 동선을 최적화할 수 있는 곳으로 골라야지.", type: "teto" }
                ]
            },
            {
                question: "11. 애인이 당신을 위한 깜짝 이벤트를 준비했다. 하지만 당신의 촉은 왠지 모르게 불길하다. 그 이유는?",
                options: [
                    { text: "음... 뭔가 어설픈데? 혹시 실패할까 봐 내가 더 불안하네. 그래도 기뻐해 줘야지. 아는 척 하지 말자.", type: "egen" },
                    { text: "평소 행동 패턴에서 벗어나는 이상 징후가 포착됐어. 분명 이벤트를 기획하고 있을 텐데, 어떤 목표를 가지고 있는지 예측해봐야겠군.", type: "teto" }
                ]
            },
            {
                question: "12. 길을 걷다 어딘가에 홀린 듯 비틀거리는 친구를 발견했다. 당신의 외침은?",
                options: [
                    { text: "야! 너 괜찮아? 넋이 나간 것 같은데... 무슨 일 있어? 내가 옆에 있어줄게, 말해봐.", type: "egen" },
                    { text: "친구, 정신 차려! 지금 너의 현재 상태가 매우 불안정해 보여. 주변에 위험 요소는 없는지 확인하고, 일단 안전한 곳으로 이동하자.", type: "teto" }
                ]
            }
        ];

        // 결과 정의 (호호님과 논의했던 결과들 모두 포함)
        // **결과 타입별 이모지 추가**
        const results = {
            'egen_pure': {
                title: "감성 과몰입형 '촉촉한 눈망울' 에겐 EMOJI_5",
                description: "이 세상 감성은 내가 다 가져간다! 모든 것을 사랑으로 해석하고 감동받는 당신은 진정한 '눈물의 여왕/왕자님'이군요. 길을 가다 낙엽만 봐도 시 한 편을 읊을 것 같은 로맨티시스트! 당신 옆엔 항상 따뜻한 보온병처럼 당신의 감성을 이해해 줄 짝꿍이 필요해요. '드라마 찐팬'인 당신은 연인과의 소소한 일상도 영화처럼 만들어낼 재주꾼이랍니다!"
            },
            'teto_pure': {
                title: "논리 초월형 '팩트 폭격기' 테토 EMOJI_6",
                description: "감성은 잠시 넣어둬, 나에겐 오직 팩트와 논리, 그리고 효율성뿐! 감성보다는 이성이 지배하는 당신은 '차가운 도시 남자/여자'의 표본입니다. 연애도 비즈니스처럼 계획하고 실행하는 당신은 어쩌면 완벽한 데이트 플래너일지도요? 계산기보다 정확한 당신의 매력을 알아봐 줄, 엉뚱 발랄한 파트너를 만나면 의외의 케미가 터질 수 있어요!"
            },
            'balanced_mixed': {
                title: "반전 매력 뿜뿜 '밀당 고수' 에그또 (EgTo) ✨",
                description: "감성과 이성 사이를 오가는 당신은 진정한 관계의 달인! 때로는 눈물짓게 만드는 공감 요정이다가, 결정적인 순간엔 칼 같은 이성으로 모두를 놀라게 하는 반전 매력의 소유자군요. 당신의 예측 불가능한 매력에 상대방은 헤어 나올 수 없을 거예요! 하지만 때로는 어떤 모습이 진짜 당신인지 혼란스러울 때도 있으니, 당신의 속마음을 알아줄 섬세한 상대를 만나면 좋겠어요."
            },
            'egen_with_realism': {
                title: "'눈물 흘리면서도 짠테크하는' 현실 공감 에겐 EMOJI_7EMOJI_8",
                description: "당신은 감성의 바다에서 헤엄치지만, 발끝은 언제나 단단한 땅에 닿아있는 현실주의자! 영화 속 이별 장면에 눈물을 펑펑 쏟다가도, 끝나자마자 '저 식당 파스타 비싸겠는데?'라고 생각하는 당신은, 뜨거운 가슴과 차가운 머리를 동시에 가진 매력적인 사람이에요. 로맨틱한 데이트를 꿈꾸지만, 예약 없으면 줄 안 서는 합리적인 선택을 하죠. 당신의 현실적인 면모까지 사랑해 줄 반전 매력의 소유자를 만나보세요!"
            },
            'teto_with_warmth': {
                title: "'겉바속촉' 반전 매력 테토 EMOJI_9EMOJI_10",
                description: "겉은 바삭한 차가운 이성의 갑옷을 입고 있지만, 속은 촉촉한 따뜻함으로 가득 찬 당신! 친구가 울면 논리적으로 '울지마, 심장이 1분 동안 37.8kcal를 소비해'라고 말하면서도, 다음 날 몰래 그 친구가 좋아하는 커피를 사다 놓는 유형이 바로 당신입니다. 감정 표현이 서툴러도 당신의 진심은 통하기 마련! 당신의 무심한 듯 섬세한 배려심을 알아봐 줄 눈치 빠른 파트너를 만나면 인생 역전 로맨스가 펼쳐질 거예요!"
            },
            'egen_extreme': {
                title: "'단일 세포' 오직 한 길 에겐 EMOJI_11",
                description: "당신은 감성으로 대동단결된, 마치 촉각 세포로만 이루어진 것 같은 순수 에겐! 길거리에서 발 구르는 아이를 보면 함께 구르고 싶은 충동을 느끼죠. '이게 논리적으로 말이 되냐?'는 질문은 당신의 사전에 없어요. 오직 '마음이 시키는 대로!' 당신의 뜨거운 심장을 알아주고, 가끔은 냉철한 조언으로 현실로 데려와 줄 파트너를 만난다면 최강의 팀워크를 자랑할 거예요!"
            },
            'teto_extreme': {
                title: "'단일 세포' 오직 한 길 테토 EMOJI_12",
                description: "당신은 AI조차 혀를 내두를 완벽한 논리 회로! 오직 팩트와 데이터, 그리고 효율성만으로 이 세상을 살아가는 로봇 같은 테토입니다. '나 지금 되게 센치해...'라는 말에 '음, 혈액 검사 받아봐야 하는 것 아닌가?'라고 반응하는 당신. 하지만 의외로 당신의 계산적인 모습이 상대방에겐 신뢰감과 든든함으로 다가올 수 있어요. 당신의 철벽 같은 방패를 뚫고 들어올 용감한 감성형 파트너를 찾아보세요!"
            }
        };

        // 각 문항 하단에 들어갈 '솔로몬의 선택' 행사 설명 문장 배열
        // **이모지 추가**
        const eventDescriptions = [
            'EMOJI_13 ‘솔로몬의 선택’은 성남시 청년들이 모여 새로운 인연을 맺는 만남 주선 행사다.',
            '⭐ 이 행사는 실제 커플이 탄생하고 결혼·출산까지 이어진 사례를 보유하고 있다.',
            'EMOJI_14 누적 커플 수는 3년간 398쌍에 달한다.',
            'EMOJI_15 참가자들의 평균 매칭률은 약 49.1%로 높은 수준을 유지하고 있다.',
            'EMOJI_16 뉴욕타임스, BBC, 로이터 등에서 보도한 공공 만남 행사로는 드문 사례다.',
            'EMOJI_17 KAIST AI 대학원과 협력한 매칭 프로그램으로 조 편성이 이뤄진다.',
            'EMOJI_18 로테이션 대화, 연애 코칭 등 다양한 프로그램이 마련되어 있다.',
            'EMOJI_19 평균 경쟁률은 약 6:1로, 높은 관심을 받고 있는 행사다.',
            '⬆️ 다수의 지자체가 벤치마킹하는 대표적인 만남 행사다.',
            '✅ 실제 참가자들로부터 높은 만족도 평가를 받고 있다.',
            'EMOJI_20 신청 기간 내 지원자 중 100명을 무작위로 선정해 참가 기회를 제공한다.',
            'EMOJI_21 ‘솔로몬의 선택’은 2023년부터 현재까지 지속 운영되고 있다.'
        ];

        // JS 로직
        // 테스트 재시작 함수
        function restartTest() {
            currentQuestionIndex = 0;
            userAnswers = [];
            egenScore = 0;
            tetoScore = 0;
            shareOptionContainer.style.display = 'none'; // 공유 옵션 숨기기
            resultSection.style.display = 'none';
            introSection.style.display = 'flex'; /* 인트로 화면 표시 */
            progressBar.style.width = '0%'; // 프로그레스 바 초기화
            // 질문 페이지의 옵션 'selected' 클래스 초기화
            const allOptions = document.querySelectorAll('.option');
            allOptions.forEach(option => option.classList.remove('selected'));
            updateNavigationButtons(); // 재시작 시 버튼 상태 초기화
            // 컨테이너 스크롤 상단으로 이동 (내용이 길어서 스크롤이 생겼을 경우를 대비)
            introSection.scrollTop = 0;
            questionSection.scrollTop = 0;
            resultSection.scrollTop = 0;
        }

        // 질문 표시 함수
        function displayQuestion(index) {
            if (index < 0 || index >= questions.length) return;

            currentQuestionIndex = index;
            questionText.textContent = questions[currentQuestionIndex].question; // **textContent 사용으로 변경 (수동 <br> 태그 제거했으므로)**
            optionsContainer.innerHTML = ''; // 옵션 초기화

            questions[currentQuestionIndex].options.forEach((option, i) => {
                const optionDiv = document.createElement('div');
                optionDiv.classList.add('option');
                optionDiv.textContent = option.text; // **textContent 사용으로 변경**
                optionDiv.dataset.type = option.type; // egen 또는 teto 타입 저장
                optionDiv.dataset.index = i; // 옵션 인덱스 저장

                // 이전에 선택한 답변이 있다면 표시
                if (userAnswers[currentQuestionIndex] && userAnswers[currentQuestionIndex].index === i) {
                    optionDiv.classList.add('selected');
                }

                optionDiv.addEventListener('click', () => selectOption(optionDiv, currentQuestionIndex));
                optionsContainer.appendChild(optionDiv);
            });

            // 각 문항 하단에 이벤트 설명 문장 추가
            // 기존에 추가된 설명이 있다면 제거 후 다시 추가 (이전/다음 버튼으로 이동 시)
            let existingDesc = questionSection.querySelector('.event-description-text'); // questionSection 내에서 찾음
            if (existingDesc) {
                existingDesc.remove();
            }

            const eventDescParagraph = document.createElement('p');
            eventDescParagraph.classList.add('event-description-text');
            // 문항 인덱스에 맞는 설명이 있고, 설명 배열 범위를 넘지 않을 경우에만 표시
            if (currentQuestionIndex < eventDescriptions.length) {
                eventDescParagraph.textContent = eventDescriptions[currentQuestionIndex];
                // eventDescParagraph를 navigation div 앞에 삽입
                const navigationDiv = questionSection.querySelector('.navigation');
                questionSection.insertBefore(eventDescParagraph, navigationDiv);
            }
            
            updateNavigationButtons();
            updateProgressBar();
            questionSection.scrollTop = 0; // 질문 변경 시 스크롤 상단으로 이동
        }

        // 옵션 선택 함수
        function selectOption(selectedOptionDiv, questionIndex) {
            Array.from(optionsContainer.children).forEach(option => {
                option.classList.remove('selected');
            });
            selectedOptionDiv.classList.add('selected');

            userAnswers[questionIndex] = {
                type: selectedOptionDiv.dataset.type,
                index: parseInt(selectedOptionDiv.dataset.index)
            };
            nextBtn.disabled = false; // 옵션 선택 시 다음 버튼 활성화
        }

        // 네비게이션 버튼 업데이트
        function updateNavigationButtons() {
            prevBtn.disabled = (currentQuestionIndex === 0);
            nextBtn.textContent = (currentQuestionIndex === questions.length - 1) ? '결과보기' : '다음';
            nextBtn.disabled = (userAnswers[currentQuestionIndex] === undefined); // 답변하지 않았으면 비활성화
        }

        // 진행률 바 업데이트
        function updateProgressBar() {
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // 점수 계산 및 결과 표시
        function calculateAndDisplayResult() {
            egenScore = 0;
            tetoScore = 0;

            userAnswers.forEach(answer => {
                if (answer && answer.type === 'egen') {
                    egenScore++;
                } else if (answer && answer.type === 'teto') {
                    tetoScore++;
                }
            });

            const finalResult = results[getCalculatedResultKey()];
            resultTitle.innerHTML = finalResult.title;
            resultDescription.innerHTML = finalResult.description;

            // 질문 페이지의 설명 제거 (결과 페이지로 넘어갈 때)
            let existingDesc = questionSection.querySelector('.event-description-text');
            if (existingDesc) {
                existingDesc.remove();
            }

            // 화면 전환
            questionSection.style.display = 'none';
            resultSection.style.display = 'flex'; /* flexbox로 변경하여 내용 중앙 정렬 */
            resultSection.scrollTop = 0; // 결과 페이지 스크롤 상단으로
        }

        // 현재 계산된 결과 키를 반환하는 헬퍼 함수
        function getCalculatedResultKey() {
            let es = 0;
            let ts = 0;
            userAnswers.forEach(answer => {
                if (answer && answer.type === 'egen') {
                    es++;
                } else if (answer && answer.type === 'teto') {
                    ts++;
                }
            });

            if (es === 12) return 'egen_extreme';
            if (ts === 12) return 'teto_extreme';
            if (es >= 10) return 'egen_pure';
            if (ts >= 10) return 'teto_pure';
            if (es >= 8 && es < 10) return 'egen_with_realism'; // 8점 이상 10점 미만
            if (ts >= 8 && ts < 10) return 'teto_with_warmth'; // 8점 이상 10점 미만
            return 'balanced_mixed';
        }

        // 이벤트 리스너 설정
        startBtn.addEventListener('click', () => {
            introSection.style.display = 'none';
            questionSection.style.display = 'flex';
            displayQuestion(currentQuestionIndex);
        });

        prevBtn.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                displayQuestion(currentQuestionIndex - 1);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (userAnswers[currentQuestionIndex] !== undefined) {
                if (currentQuestionIndex < questions.length - 1) {
                    displayQuestion(currentQuestionIndex + 1);
                } else {
                    calculateAndDisplayResult();
                }
            } else {
                alert('답변을 선택해주세요!');
            }
        });

        restartBtn.addEventListener('click', restartTest);

        // '내 결과 공유하기' 버튼 클릭 시 공유 옵션 표시/숨기기
        shareMyResultBtn.addEventListener('click', () => {
            shareOptionContainer.style.display = (shareOptionContainer.style.display === 'none' || shareOptionContainer.style.display === '') ? 'flex' : 'none';
        });

        // 솔로몬 신청 링크 (별도의 변수로 정의하여 재사용)
        const SOLO_MON_APPLY_LINK = "https://www.seongnam.go.kr/apply/view.do?appIdx=2987&currentPage=1";

        // 카카오톡 공유 기능
        shareKakaoBtn.addEventListener('click', () => {
            if (!Kakao.isInitialized()) {
                alert('카카오톡 SDK가 초기화되지 않았습니다. 개발자 키 설정을 확인해주세요.');
                return;
            }

            const currentResult = results[getCalculatedResultKey()];
            // 결과 제목에서 이모지를 제거 (카카오톡 제목 길이에 맞추기 위함)
            const cleanedTitle = currentResult.title.replace(/[\u{1F000}-\u{1FFFF}|\u{2000}-\u{2FFF}]/gu, '').trim(); 
            
            // 설명에 결과 본문과 행사 정보를 최대한 담기 (카카오톡 글자 수 제한 내에서)
            const fullDescription = `${currentResult.description}\n\n성남시 청춘남녀 만남행사 'SOLO MON의 선택'에 참가하세요! 내 이상형을 만날 기회! 지금 바로 신청하세요: ${SOLO_MON_APPLY_LINK}`;

            Kakao.Share.sendDefault({
                objectType: 'feed',
                content: {
                    title: `[솔로몬의 선택] 내 연애 성향은? ${cleanedTitle}`, // 결과 제목을 포함하여 더 풍부하게
                    description: fullDescription, // 결과 본문 + 행사 정보 최대한 포함
                    imageUrl: 'https://cdn.pixabay.com/photo/2016/11/22/19/25/emotions-1850125_1280.png', // 대표 이미지 URL
                    link: {
                        mobileWebUrl: window.location.href,
                        webUrl: window.location.href,
                    },
                },
                buttons: [
                    {
                        title: '테스트 결과 자세히 보기',
                        link: {
                            mobileWebUrl: window.location.href,
                            webUrl: window.location.href,
                        },
                    },
                    {
                        title: 'EMOJI_22 솔로몬의 선택 신청하기 EMOJI_23',
                        link: {
                            mobileWebUrl: SOLO_MON_APPLY_LINK,
                            webUrl: SOLO_MON_APPLY_LINK,
                        },
                    }
                ],
            });
        });

        // URL 복사 기능
        copyUrlBtn.addEventListener('click', () => {
            const currentResult = results[getCalculatedResultKey()];
            const shareText = `[솔로몬의 선택] 내 연애 성향 타입은? ${currentResult.title}\n${currentResult.description}\n\n솔로몬의 선택 참가 신청: ${SOLO_MON_APPLY_LINK}\n\n테스트 바로가기: ${window.location.href}`;
            
            const el = document.createElement('textarea');
            el.value = shareText;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
            alert('테스트 내용과 솔로몬의 선택 신청 링크가 복사되었습니다!');
        });

        // Facebook 공유
        shareFacebookBtn.addEventListener('click', () => {
            const currentResult = results[getCalculatedResultKey()];
            const shareText = `[솔로몬의 선택] 내 연애 성향 타입은? ${currentResult.title}\n${currentResult.description}\n\n솔로몬의 선택 참가 신청: ${SOLO_MON_APPLY_LINK}\n\n`; // 본문 끝에 링크 추가
            const shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}&quote=${encodeURIComponent(shareText)}`;
            window.open(shareUrl, '_blank', 'width=600,height=400');
        });

        // LINE 공유
        shareLineBtn.addEventListener('click', () => {
            const currentResult = results[getCalculatedResultKey()];
            const shareText = `[솔로몬의 선택] 내 연애 성향 타입은? ${currentResult.title}\n${currentResult.description}\n\n솔로몬의 선택 참가 신청: ${SOLO_MON_APPLY_LINK}\n\n${window.location.href}`;
            const shareUrl = `https://social-plugins.line.me/lineit/share?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent(shareText)}`;
            window.open(shareUrl, '_blank', 'width=600,height=400');
        });

        // X (Twitter) 공유
        shareXBtn.addEventListener('click', () => {
            const currentResult = results[getCalculatedResultKey()];
            const shareText = `[솔로몬의 선택] 내 연애 성향 타입은? ${currentResult.title} - ${currentResult.description}\n\n솔로몬의 선택 참가 신청: ${SOLO_MON_APPLY_LINK}`; // 텍스트 끝에 링크 추가
            const shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(window.location.href)}`;
            window.open(shareUrl, '_blank', 'width=600,height=400');
        });

        // 페이지 로드 시 초기화 (display: none으로 초기화하고 인트로만 display:flex)
        window.addEventListener('load', () => {
            document.querySelectorAll('.container').forEach(el => el.style.display = 'none');
            introSection.style.display = 'flex';
        });
    </script>
</body>
</html>